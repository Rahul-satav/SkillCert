<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SkillCert — Skill Validation</</title>

  <!-- Tailwind (for quick, modern UI) -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <!-- html2pdf -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

  <style>
    body{background:#f5f6fa;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
    /* Certificate card */
    .cert-container{
      width:100%;
      max-width:1100px;
      margin:0 auto;
      background:#fff;
      border:6px solid #d4af37;     /* gold frame */
      border-radius:20px;
      padding:40px;
      position:relative;
      overflow:hidden;               /* prevent clip issues in export */
    }
    /* Title */
    .cert-title{font-size:52px;font-weight:800;letter-spacing:.1em;color:#4b3621}
    /* Divider */
    .fancy-hr{height:2px;background:linear-gradient(90deg,transparent,#3b82f6,transparent)}
    /* Medal */
    .medal{
      background:radial-gradient(circle at 30% 30%,#ffd966,#d4af37);
      height:52px;width:52px;border-radius:50%;
      display:flex;align-items:center;justify-content:center;
      font-weight:700;font-size:20px;color:#4b3621;
      box-shadow:0 4px 8px rgba(0,0,0,.1)
    }
    @media (max-width:768px){
      .cert-container{padding:20px}
      #certName{font-size:48px}
    }
  </style>
</head>
<body class="min-h-screen flex flex-col items-center p-4">

  <!-- Header -->
  <header class="text-center mb-10">
    <h1 class="text-4xl font-extrabold text-gray-800 mb-2">SkillCert — Online Skill Test</h1>
    <p class="text-gray-500">Take a quick skill test and get your professional certificate instantly</p>
  </header>

  <!-- User details + skill select -->
  <section class="w-full max-w-lg bg-white rounded-xl shadow p-6 mb-8">
    <h2 class="text-xl font-semibold mb-4">Your Details</h2>

    <label class="block mb-3 text-sm font-medium">
      Full Name
      <input id="fullName" class="mt-1 w-full border rounded px-3 py-2" placeholder="Enter your name"/>
    </label>

    <h2 class="text-xl font-semibold mt-4 mb-2">Select a Skill</h2>
    <select id="skillSelect" class="w-full border rounded px-3 py-2">
      <option disabled selected>Choose a skill</option>
      <option>Java</option>
      <option>Angular</option>
      <option>React</option>
      <option>Node.js</option>
      <option>SQL</option>
      <option>Python</option>
      <option>FastAPI</option>
      <option>Data Analysis</option>
      <option>AWS</option>
      <option>Cyber Security</option>
    </select>

    <button id="startQuiz" class="mt-4 w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700">
      Start Quiz
    </button>
  </section>

  <!-- Quiz -->
  <section id="quizSection" class="w-full max-w-xl bg-white rounded-xl shadow p-6 hidden">
    <h2 class="text-xl font-semibold mb-4">Skill Quiz</h2>
    <p id="quizSkillLabel" class="text-sm text-gray-500 mb-2"></p>
    <form id="quizForm" class="space-y-4"></form>
    <button id="submitQuiz" class="mt-4 w-full bg-green-600 text-white py-2 rounded hover:bg-green-700">
      Submit Quiz
    </button>
  </section>

  <!-- Fail -->
  <div id="failMessage" class="hidden mt-6 text-center">
    <p class="text-red-600 font-semibold mb-3">❌ You scored below 80%. Please try again!</p>
    <button id="retakeBtn" class="bg-blue-600 text-white px-4 py-2 rounded">Retake Quiz</button>
  </div>

  <!-- Certificate -->
  <section id="certificateSection" class="hidden w-full flex justify-center mt-10">
    <div id="certCard" class="cert-container">
      <div class="flex flex-col h-full">
        <!-- Top -->
        <div class="text-center">
          <div class="cert-title">CERTIFICATE</div>
          <div class="mt-1 text-[13px] tracking-[0.25em] text-slate-600 font-semibold">
            OF COMPLETING A SKILL VALIDATION TEST
          </div>
          <div class="mt-5 text-[12px] tracking-wide text-slate-500">
            This Official Credential Is Conferred Upon
          </div>
          <div id="certName" class="mt-2 text-[64px] font-extrabold text-blue-700 capitalize">Name</div>
        </div>

        <div class="mx-[100px] mt-6"><div class="fancy-hr"></div></div>

        <div class="mt-5 text-center text-[15px] text-slate-700 leading-relaxed px-[80px] max-w-[900px] mx-auto">
          Has successfully completed, mastered, and rigorously validated their advanced expertise in the
          <b id="certSkill">Skill</b> skill test, achieving an exceptional and commendable final score of
          <b id="certScore">100%</b>, thereby securing the highly-coveted <b id="certLevel">Advanced</b> level certification.
        </div>

        <!-- Footer (centered) -->
        <div class="mt-8 flex flex-col items-center justify-center gap-2">
          <div id="medal" class="medal">1</div>
          <div class="text-[12px] text-slate-500 leading-tight text-center">
            Issued by <b>Rahul Shahaji Satav</b> • Date: <span id="certDate"></span>
          </div>
          <div class="text-[12px] text-slate-500 leading-tight text-center">
            UID: <span id="certUID">—</span>
          </div>

          <!-- Inline SVG Logo (no CORS issues) -->
          <div class="mt-1 flex items-center gap-2">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="none">
              <circle cx="12" cy="12" r="11" fill="#1e40af" opacity=".15"/>
              <path d="M7 12l3 3 7-7" stroke="#1e40af" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <div class="text-[26px] font-extrabold"
                 style="background:linear-gradient(90deg,#1e40af,#3b82f6);-webkit-background-clip:text;color:transparent">
              SkillCert
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Download again button -->
  <div id="downloadRow" class="hidden mt-6">
    <button id="downloadBtn" class="bg-indigo-600 text-white px-5 py-2 rounded hover:bg-indigo-700">
      Download PDF Again
    </button>
  </div>

<script>
/* ------------------ Question bank (5 per skill) ------------------ */
const quizData = {
  "Java":[
    {q:"What is Java mainly used for?",a:["AI","Web","Games","Design"],c:1},
    {q:"Java supports ___ programming",a:["Functional","Object-Oriented","Procedural","None"],c:1},
    {q:"Keyword to inherit a class?",a:["this","super","extends","implements"],c:2},
    {q:"Which is NOT a Java feature?",a:["Platform Independent","Secure","Dynamic","Pointer Arithmetic"],c:3},
    {q:"JVM stands for…",a:["Java Virtual Machine","Just Virtual Mode","Java Vendor Management","None"],c:0}
  ],
  "Angular":[
    {q:"Angular is a…",a:["Language","Framework","Database","Runtime"],c:1},
    {q:"Two-way binding uses…",a:["[]","()","[()]","{}"],c:2},
    {q:"Service is injected using…",a:["DI","AJAX","SSR","CSR"],c:0},
    {q:"CLI command to create component?",a:["ng c","ng g c","ng n c","ng new c"],c:1},
    {q:"Template syntax is…",a:["{{ }}","[[ ]]","<< >>","( )"],c:0}
  ],
  "React":[
    {q:"React state updates are…",a:["Async","Sync","Blocking","None"],c:0},
    {q:"JSX compiles to…",a:["React.createElement","HTML","DOM nodes","CSS"],c:0},
    {q:"Hook for side effects?",a:["useEffect","useState","useMemo","useRef"],c:0},
    {q:"Keys in lists should be…",a:["Stable & unique","Random","Index always","Same key"],c:0},
    {q:"Lifting state up means…",a:["Move to common parent","Use context only","Global var","Refs"],c:0}
  ],
  "Node.js":[
    {q:"Node.js runs on…",a:["Browser","Server-side JS runtime","DB","OS"],c:1},
    {q:"Package manager?",a:["npm","pip","mvn","gradle"],c:0},
    {q:"Express is…",a:["DB","Framework","CLI","ORM"],c:1},
    {q:"CommonJS import uses…",a:["require","import","using","load"],c:0},
    {q:"Environment variables from .env via…",a:["dotenv","envload","loadenv","config"],c:0}
  ],
  "SQL":[
    {q:"Returns rows…",a:["SELECT","PUT","FIND","GET"],c:0},
    {q:"JOIN combines rows from…",a:["Multiple tables","One column","File","Logs"],c:0},
    {q:"Filter rows…",a:["WHERE","ORDER","GROUP","HAVING only"],c:0},
    {q:"Aggregate func?",a:["COUNT","PRINT","SUMIF","MAP"],c:0},
    {q:"Primary key is…",a:["Unique identifier","Foreign key","View","File"],c:0}
  ],
  "Python":[
    {q:"Python is…",a:["Compiled only","Interpreted (mostly)","Assembly","Bytecode only"],c:1},
    {q:"Dict literal is…",a:["[]","()","{}","<>"],c:2},
    {q:"Virtual env tool?",a:["venv","npm","conda install node","gradle"],c:0},
    {q:"Pandas used for…",a:["Data analysis","Web sockets","3D games","Auth"],c:0},
    {q:"PEP8 relates to…",a:["Style guide","Package manager","DB","Web server"],c:0}
  ],
  "FastAPI":[
    {q:"FastAPI is a…",a:["Python web framework","JS runtime","DB","Message queue"],c:0},
    {q:"Default server commonly used?",a:["Uvicorn","Tomcat","Jetty","Apache"],c:0},
    {q:"Type hints are used for…",a:["Validation & docs","Speed only","No use","Security"],c:0},
    {q:"Auto docs URL…",a:["/docs","/apidoc","/swagger","/openapi"],c:0},
    {q:"Dependency injection available?",a:["Yes","No","Only plugins","Deprecated"],c:0}
  ],
  "Data Analysis":[
    {q:"Tool widely used?",a:["Pandas","Nginx","Kafka Connect","Babel"],c:0},
    {q:"Mean is…",a:["Average","Middle value","Most frequent","Range"],c:0},
    {q:"Visualization lib?",a:["Matplotlib","Requests","Boto3","Cryptography"],c:0},
    {q:"CSV stands for…",a:["Comma-Separated Values","Custom Service Values","Common Save Variant","None"],c:0},
    {q:"EDA stands for…",a:["Exploratory Data Analysis","Extra Data Audit","Entity Data Access","None"],c:0}
  ],
  "AWS":[
    {q:"S3 is…",a:["Object storage","Compute","Queue","DB"],c:0},
    {q:"EC2 provides…",a:["Virtual servers","Object store","Warehouse","Email"],c:0},
    {q:"Lambda is…",a:["Serverless compute","File storage","VPC","CDN"],c:0},
    {q:"RDS manages…",a:["Relational DBs","Queues","Monitoring","DNS"],c:0},
    {q:"CloudFront is a…",a:["CDN","SQL engine","IDE","OS"],c:0}
  ],
  "Cyber Security":[
    {q:"CIA triad means…",a:["Confidentiality, Integrity, Availability","Control, Inspect, Audit","Code, Infra, Access","None"],c:0},
    {q:"Hashing is…",a:["One-way","Two-way","Encryption","Compression"],c:0},
    {q:"MFA adds…",a:["Extra auth factor","Firewall","VPN","Proxy"],c:0},
    {q:"OWASP focuses on…",a:["Web app security","Network routing","Kernel dev","Cloud billing"],c:0},
    {q:"Phishing targets…",a:["Users","Routers","Cables","CDNs"],c:0}
  ]
};

const $ = s => document.querySelector(s);
const quizSection = $("#quizSection"), quizForm = $("#quizForm");
const submitBtn = $("#submitQuiz"), startBtn = $("#startQuiz");
const failMessage = $("#failMessage"), retakeBtn = $("#retakeBtn");
const certificateSection = $("#certificateSection");
const downloadRow = $("#downloadRow"), downloadBtn = $("#downloadBtn");

/* Start quiz */
startBtn.addEventListener("click", ()=>{
  const name = $("#fullName").value.trim();
  const skill = $("#skillSelect").value;

  if(!name){ alert("Please enter your name."); return; }
  if(!skill || skill==="Choose a skill"){ alert("Please select a skill."); return; }

  generateQuiz(skill);
  $("#quizSkillLabel").textContent = `Skill: ${skill}`;
  quizSection.classList.remove("hidden");
  window.scrollTo({top: quizSection.offsetTop-20, behavior: "smooth"});
});

/* Build quiz */
function generateQuiz(skill){
  quizForm.innerHTML = "";
  const items = quizData[skill];
  if(!items){ alert("Questions for this skill are not available yet."); return; }

  items.forEach((item, idx)=>{
    const block = document.createElement("div");
    block.className = "border rounded p-3";
    block.innerHTML = `
      <p class="font-semibold mb-2">${idx+1}. ${item.q}</p>
      ${item.a.map((opt,i)=>`
        <label class="block"><input type="radio" name="q${idx}" value="${i}" class="mr-2"> ${opt}</label>
      `).join("")}
    `;
    quizForm.appendChild(block);
  });

  submitBtn.onclick = ()=> gradeQuiz(skill);
}

/* Grade */
function gradeQuiz(skill){
  const items = quizData[skill];
  let correct = 0;
  for(let i=0;i<items.length;i++){
    const chosen = (quizForm[`q${i}`] || {}).value;
    if(chosen!==undefined && Number(chosen)===items[i].c) correct++;
  }
  const pct = Math.round((correct/items.length)*100);

  if(pct>=80){
    buildCertificate(skill, pct);
    certificateSection.classList.remove("hidden");
    failMessage.classList.add("hidden");
    quizSection.classList.add("hidden");
    downloadRow.classList.remove("hidden");
    setTimeout(downloadPDF, 600);
  }else{
    certificateSection.classList.add("hidden");
    failMessage.classList.remove("hidden");
    quizSection.classList.add("hidden");
    downloadRow.classList.add("hidden");
  }
}

/* Fill certificate */
function buildCertificate(skill, pct){
  const name = $("#fullName").value.trim();
  const level = pct>=93 ? "Advanced" : (pct>=85 ? "Proficient" : "Intermediate");
  const medal = pct>=93 ? "1" : (pct>=85?"2":"3");
  $("#certName").textContent = name || "Candidate";
  $("#certSkill").textContent = skill;
  $("#certScore").textContent = `${pct}%`;
  $("#certLevel").textContent = level;
  $("#certDate").textContent = new Date().toLocaleDateString();
  $("#certUID").textContent = makeUID(8);
  $("#medal").textContent = medal;
}

/* UID */
function makeUID(n=8){
  const s="ABCDEFGHJKLMNPQRSTUVWXYZ23456789"; let o="";
  for(let i=0;i<n;i++) o+=s[Math.floor(Math.random()*s.length)];
  return o;
}

/* ---------- Mobile-safe PDF export: render a fixed A4 clone off-screen ---------- */
function downloadPDF () {
  const src = document.getElementById('certCard');

  // create off-screen A4 clone (prevents cropping / blank pdf on phones)
  const clone = src.cloneNode(true);
  clone.id = 'certCardClone';
  Object.assign(clone.style, {
    width: '794px',           // A4 width @ 96dpi
    minHeight: '1123px',      // A4 height
    boxSizing: 'border-box',
    padding: '40px',
    position: 'absolute',
    left: '-10000px',
    top: '0',
    margin: '0',
    maxWidth: 'none',
    overflow: 'hidden',
    background: '#ffffff'
  });
  document.body.appendChild(clone);

  const opts = {
    margin: 0,
    filename: 'SkillCert_Certificate.pdf',
    image: { type: 'jpeg', quality: 0.98 },
    html2canvas: {
      scale: 2,
      useCORS: true,
      scrollX: 0,
      scrollY: 0,
      windowWidth: 794,
      windowHeight: 1123
    },
    jsPDF: { unit: 'px', format: [794, 1123], orientation: 'portrait' },
    pagebreak: { mode: ['css','avoid-all'] }
  };

  window.scrollTo(0,0);

  html2pdf()
    .from(clone)
    .set(opts)
    .save()
    .finally(()=> clone.remove());
}

/* Manual download button */
downloadBtn?.addEventListener('click', downloadPDF);

/* Retake */
retakeBtn.addEventListener("click", ()=> location.reload());
</script>
</body>
</html>
